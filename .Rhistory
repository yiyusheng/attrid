data.flist_uwork <- data.flist[,c('ip','svr_id','f_time','class','ftype','group')]
# 2. 读取helper数据
load(file.path(dir_data,'flist(helper[2008-2013]).Rda'))
data.flist_helper <- data.flist[,c('ip','svr_id','f_time','class','ftype','group')]
# 3. 合并数据
data.flist <- rbind(data.flist_helper,data.flist_uwork)
data.flist$group <- factor(data.flist$group)
data.flist <- factorX(data.flist)
a <- subset(data.flist,svr_id == 'TYSV12122459')
View(a)
a <- subset(data.flist,svr_id == 'TYSV09030476-L')
View(a)
dayDup <- 3
data.pretFlist <- subset(data.flist,class == -1)
data.flist <- subset(data.flist,class != -1)
a <- subset(data.flist,svr_id == 'TYSV09030476-L')
data.flist <- dedupTime(data.flist,dayDup)
a <- subset(data.flist,svr_id == 'TYSV09030476-L')
View(a)
b <- dedupTime(a,3)
a
b <- dedupTime(a,3)
a <- subset(data.flist,svr_id == 'TYSV09030476-L')
dedupTime(a,3)
data.flist <- 3
data.flist <- a
dayDup <- 3
data.flist <- data.flist[order(data.flist$ip,data.flist$f_time),]
data.flist$svr_id <- as.character(data.flist$svr_id)
delset <- numeric()
pSvrid <- data.flist$svr_id[1]
pFtime <- data.flist$f_time[1]
i=2
curSvrid <- data.flist$svr_id[i]
curFtime <- data.flist$f_time[i]
curSvrid == pSvrid
difftime(curFtime,pFtime,tz = 'UTC',units = 'days') > dayDup
curFtime
pFtime
pFtime <- curFtime
i =3
curSvrid <- data.flist$svr_id[i]
curFtime <- data.flist$f_time[i]
curSvrid == pSvrid &
difftime(curFtime,pFtime,tz = 'UTC',units = 'days') > dayDup
source('~/Code/R/dataLoadforDiskAnalysis/loadFunc.R')
dedupTime(a,3)
source('~/Code/R/dataLoadforDiskAnalysis/Failure_list_preprocess(ALL).R')
source('~/Code/R/dataLoadforDiskAnalysis/Disk_number_label.R')
source('~/Code/R/dataLoadforDiskAnalysis/attr_load.R')
source('~/Code/R/dataLoadforDiskAnalysis/attr_load.R')
a <- data.f[data.f$use_time > data.f$f_time,]
a <- subset(data.flist,use_time > f_time)
a <- subset(data.flist,svr_id == 'TYSV09030476-L')
View(a)
setwd('~/Code/R/attrid/')
rm(list = ls())
source('head.R')
#@@@ CONFIGURE @@@#
load(file.path(dir_dataSource,'load_ftr_attrid.Rda'))
useOld <- 1
if (useOld == 1){
lowerTime <- as.POSIXct('2013-01-01')
upperTime <- as.POSIXct('2013-10-01')
saveName <- 'dataPrepareAFR13.Rda'
# lowerTime <- as.POSIXct('2013-06-01')
# upperTime <- as.POSIXct('2013-08-01')
# saveName <- 'dataPrepareAFR1306_1307.Rda'
}else{
lowerTime <- as.POSIXct('2014-06-01')
upperTime <- as.POSIXct('2014-08-01')
saveName <- 'dataPrepareAFR1406_1407.Rda'
}
data.f <- subset(data.flist, f_time < upperTime & f_time > lowerTime)
data.f <- subset(data.f,ip %in% cmdb$ip & svr_id %in% cmdb$svr_asset_id)
table(disk_ip$numModel)
a <- subset(disk_ip,numModel == 1)
b <- subset(mean_io, svrid %in% disk_ip$svr_id)
c <- subset(data.f,svr_id %in% disk_ip$svr_id)
b <- subset(mean_io, svrid %in% a$svr_id)
c <- subset(data.f,svr_id %in% a$svr_id)
summary(data.f)
# Data prepare for sc16
rm(list = ls())
source('head.R')
#@@@ CONFIGURE @@@#
load(file.path(dir_dataSource,'load_ftr_attrid.Rda'))
useOld <- 1
if (useOld == 1){
lowerTime <- as.POSIXct('2013-01-01')
upperTime <- as.POSIXct('2013-10-01')
saveName <- 'dataPrepareAFR13.Rda'
# lowerTime <- as.POSIXct('2013-06-01')
# upperTime <- as.POSIXct('2013-08-01')
# saveName <- 'dataPrepareAFR1306_1307.Rda'
}else{
lowerTime <- as.POSIXct('2014-06-01')
upperTime <- as.POSIXct('2014-08-01')
saveName <- 'dataPrepareAFR1406_1407.Rda'
}
# S1. Failure record prepare
data.f <- subset(data.flist, f_time < upperTime & f_time > lowerTime)
data.f <- subset(data.f,ip %in% cmdb$ip & svr_id %in% cmdb$svr_asset_id)
data.f$failShiptime <- as.numeric(difftime(data.f$f_time,data.f$use_time,tz = 'UTC',units = 'days'))/365
data.f$fsTime <- floor(data.f$failShiptime)
data.f$fsTimeN <- cut(data.f$failShiptime,c(0,1/2,1:7),include.lowest = T)
data.f$fsTimeN <- gsub('^\\[|^\\(|,.*$','',data.f$fsTimeN)
# S2. Compute online time for cmdb
cmdb$shiptimeToLeft <- as.numeric(difftime(lowerTime,cmdb$use_time,tz = 'UTC',units = 'days'))/365
cmdb$shiptimeToRight <- as.numeric(difftime(upperTime,cmdb$use_time,tz = 'UTC',units = 'days'))/365
cmdb$shTime <- floor(cmdb$shiptimeToRight)
cmdb$shTimeN <- cut(cmdb$shiptimeToRight,c(0,1/2,1:7),include.lowest = T)
cmdb$shTimeN <- gsub('^\\[|^\\(|,.*$','',cmdb$shTimeN)
cmdb$diskNum <- disk_ip$numDisk[match(cmdb$ip,disk_ip$ip)]
# S3. Label for each server
cmdb$dClass <- ''
class_C <- 'C1'
class_B <- c('B5','B6','B1')
class_TS <- c('TS1','TS3','TS4','TS5','TS6')
cmdb$dClass[cmdb$dev_class_id %in% class_C] <- 'C'
cmdb$dClass[cmdb$dev_class_id %in% class_B] <- 'B'
cmdb$dClass[cmdb$dev_class_id %in% class_TS] <- 'TS'
tmp.cmdb <- cmdbio
cmdbio <- subset(cmdb,svr_asset_id %in% mean_io$svrid &
dev_class_id %in% c(class_C,class_TS) &
shiptimeToRight > 0 & !is.na(diskNum))
tmp.cmdb <- cmdbio
tmp.f <- subset(data.f,svr_id %in% tmp.cmdb$svr_asset_id)
tmp.f$ip <- factor(tmp.f$ip)
tmp.f$svr_id <- factor(tmp.f$svr_id)
tmp.f <- mchAttr(tmp.f,tmp.cmdb,
'svr_id','svr_asset_id',
c('total','shTime','dClass'))
tmp.f <- subset(data.f,svr_id %in% tmp.cmdb$svr_asset_id)
tmp.f$ip <- factor(tmp.f$ip)
tmp.f$svr_id <- factor(tmp.f$svr_id)
tmp.f <- mchAttr(tmp.f,tmp.cmdb,
'svr_id','svr_asset_id',
c('total','shTime','dClass'))
tmp.f <- subset(data.f,svr_id %in% tmp.cmdb$svr_asset_id)
tmp.f$ip <- factor(tmp.f$ip)
tmp.f$svr_id <- factor(tmp.f$svr_id)
tmp.f <- mchAttr(tmp.f,tmp.cmdb,
'svr_id','svr_asset_id',
c('total','shTime','shTimeN','dClass'))
tmp.f <- factorX(tmp.f)
mean_io <- subset(mean_io,svrid %in% factor(cmdbio$svr_asset_id))
tmp.io <- mean_io
tmp.io <- mchAttr(tmp.io,cmdbio,'svrid','svr_asset_id',
c('dev_class_id','dClass','shTime','shTimeN','ip','shiptimeToRight'))
tmp.io <- factorX(tmp.io)
tmp.disk <- disk_ip
tmp.disk$dClass <- cmdbio$dClass[match(tmp.disk$ip,cmdbio$ip)]
tmp.cmdb <- factorX(cmdbio)
source('~/Code/R/attrid/dataPrepareAFR.R')
cmdb <- mchAttr(cmdb,disk_ip,'svr_asset_id','svr_id',
c('numDisk','numModel','uniModel'))
colcmdb <- c('svr_asset_id','ip','dev_class_id','bs1','shiptimeToLeft','shiptimeToRight',
'shTime','numDisk','numModel','uniModel')
cmdbio <- subset(cmdb,svr_asset_id %in% mean_io$svrid &
dev_class_id %in% c(class_C,class_TS) &
shiptimeToRight > 0 & !is.na(diskNum),colcmdb)
View(cmdbio)
a <- melt(table(cmdb$numDisk,cmdb$numModel,cmdb$uniModel))
View(a)
a <- subset(a,value != 0)
View(a)
?melt
a <- a[order(a$value),]
a <- a[order(a$value,decreasing = T),]
View(a)
a <- melt(table(cmdbio$numDisk,cmdbio$numModel,cmdbio$uniModel),
varnames = c('numDisk','numModel','uniModel'))
a <- a[order(a$value,decreasing = T)]
a <- subset(a,value != 0)
a <- a[order(a$value,decreasing = T),]
View(a)
data.fio <- subset(data.f,svr_asset_id %in% mean_io$svrid & dev_class_id %in% c(class_C,class_TS))
data.fio <- subset(data.f,svr_id %in% mean_io$svrid & dev_class_id %in% c(class_C,class_TS))
summary(data.fio$use_time)
data.fio <- factorX(subset(data.f,svr_id %in% mean_io$svrid & dev_class_id %in% c(class_C,class_TS)))
summary(data.fio$use_time)
# Data prepare for sc16
rm(list = ls())
source('head.R')
#@@@ CONFIGURE @@@#
load(file.path(dir_dataSource,'load_ftr_attrid.Rda'))
useOld <- 1
if (useOld == 1){
lowerTime <- as.POSIXct('2013-01-01')
upperTime <- as.POSIXct('2013-10-01')
saveName <- 'dataPrepareAFR13.Rda'
# lowerTime <- as.POSIXct('2013-06-01')
# upperTime <- as.POSIXct('2013-08-01')
# saveName <- 'dataPrepareAFR1306_1307.Rda'
}else{
lowerTime <- as.POSIXct('2014-06-01')
upperTime <- as.POSIXct('2014-08-01')
saveName <- 'dataPrepareAFR1406_1407.Rda'
}
# S1. Failure record prepare
data.f <- subset(data.flist, f_time < upperTime & f_time > lowerTime)
data.f <- subset(data.f,ip %in% cmdb$ip & svr_id %in% cmdb$svr_asset_id)
data.f$failShiptime <- as.numeric(difftime(data.f$f_time,data.f$use_time,tz = 'UTC',units = 'days'))/365
data.f$fsTime <- floor(data.f$failShiptime)
data.f$fsTimeN <- cut(data.f$failShiptime,c(0,1/2,1:7),include.lowest = T)
data.f$fsTimeN <- gsub('^\\[|^\\(|,.*$','',data.f$fsTimeN)
summary(data.f$f_time)
cmdb$shiptimeToLeft <- as.numeric(difftime(lowerTime,cmdb$use_time,tz = 'UTC',units = 'days'))/365
cmdb$shiptimeToRight <- as.numeric(difftime(upperTime,cmdb$use_time,tz = 'UTC',units = 'days'))/365
cmdb$shTime <- floor(cmdb$shiptimeToRight)
cmdb$shTimeN <- cut(cmdb$shiptimeToRight,c(0,1/2,1:7),include.lowest = T)
cmdb$shTimeN <- gsub('^\\[|^\\(|,.*$','',cmdb$shTimeN)
cmdb$dClass <- ''
class_C <- 'C1'
class_B <- c('B5','B6','B1')
class_TS <- c('TS1','TS3','TS4','TS5','TS6')
cmdb$dClass[cmdb$dev_class_id %in% class_C] <- 'C'
cmdb$dClass[cmdb$dev_class_id %in% class_B] <- 'B'
cmdb$dClass[cmdb$dev_class_id %in% class_TS] <- 'TS'
# S3.5 Label server with disk model
cmdb <- mchAttr(cmdb,disk_ip,'svr_asset_id','svr_id',
c('numDisk','numModel','uniModel'))
colcmdb <- c('svr_asset_id','ip','dev_class_id','bs1','shiptimeToLeft','shiptimeToRight',
'shTime','numDisk','numModel','uniModel')
cmdbio <- subset(cmdb,svr_asset_id %in% mean_io$svrid &
dev_class_id %in% c(class_C,class_TS) &
shiptimeToRight > 0 & !is.na(diskNum),colcmdb)
a <- melt(table(cmdbio$numDisk,cmdbio$numModel,cmdbio$uniModel),
varnames = c('numDisk','numModel','uniModel'))
a <- subset(a,value != 0)
a <- a[order(a$value,decreasing = T),]
cmdbio <- subset(cmdb,svr_asset_id %in% mean_io$svrid &
dev_class_id %in% c(class_C,class_TS) &
shiptimeToRight > 0 & !is.na(numDisk),colcmdb)
a <- melt(table(cmdbio$numDisk,cmdbio$numModel,cmdbio$uniModel),
varnames = c('numDisk','numModel','uniModel'))
a <- subset(a,value != 0)
a <- a[order(a$value,decreasing = T),]
data.fio <- factorX(subset(data.f,svr_id %in% mean_io$svrid & dev_class_id %in% c(class_C,class_TS)))
summary(data.f$f_time)
summary(data.fio$f_time)
staLab <- melt(table(cmdbio$numDisk,cmdbio$numModel,cmdbio$uniModel),
varnames = c('numDisk','numModel','uniModel'))
staLab <- subset(staLab,value != 0)
staLab <- staLab[order(staLab$value,decreasing = T),]
data.fio <- mchAttr(data.fio,disk_ip,'svr_id','svr_id',c('numDisk','numModel','uniModel'))
source(file.path(dir_code,'sc16F1Func.R'))
staLab <- ioAFR(cmdbio,data.fio,c('numDisk','numModel','uniModel'))
View(staLab)
12/596
View(staLab)
staLab <- staLab[order(staLab$count),]
staLab <- staLab[order(staLab$count,decreasing = T),]
View(staLab)
staLab <- subset(staLab,count > 10)
staLab <- staLab[order(staLab$count,decreasing = T),]
library(ggplot2)
source('~/Code/R/attrid/sc16F1Func.R')
staLab <- staLab[order(staLab$uniModel),]
View(staLab)
staLab <- staLab[order(staLab$count),]
View(staLab)
?split
# Data prepare for sc16
rm(list = ls())
source('head.R')
#@@@ CONFIGURE @@@#
load(file.path(dir_dataSource,'load_ftr_attrid.Rda'))
useOld <- 1
if (useOld == 1){
lowerTime <- as.POSIXct('2013-01-01')
upperTime <- as.POSIXct('2013-10-01')
saveName <- 'dataPrepareAFR13.Rda'
# lowerTime <- as.POSIXct('2013-06-01')
# upperTime <- as.POSIXct('2013-08-01')
# saveName <- 'dataPrepareAFR1306_1307.Rda'
}else{
lowerTime <- as.POSIXct('2014-06-01')
upperTime <- as.POSIXct('2014-08-01')
saveName <- 'dataPrepareAFR1406_1407.Rda'
}
# S1. Failure record prepare
data.f <- subset(data.flist, f_time < upperTime & f_time > lowerTime)
data.f <- subset(data.f,ip %in% cmdb$ip & svr_id %in% cmdb$svr_asset_id)
data.f$failShiptime <- as.numeric(difftime(data.f$f_time,data.f$use_time,tz = 'UTC',units = 'days'))/365
data.f$fsTime <- floor(data.f$failShiptime)
data.f$fsTimeN <- cut(data.f$failShiptime,c(0,1/2,1:7),include.lowest = T)
data.f$fsTimeN <- gsub('^\\[|^\\(|,.*$','',data.f$fsTimeN)
# S2. Compute online time for cmdb
cmdb$shiptimeToLeft <- as.numeric(difftime(lowerTime,cmdb$use_time,tz = 'UTC',units = 'days'))/365
cmdb$shiptimeToRight <- as.numeric(difftime(upperTime,cmdb$use_time,tz = 'UTC',units = 'days'))/365
cmdb$shTime <- floor(cmdb$shiptimeToRight)
cmdb$shTimeN <- cut(cmdb$shiptimeToRight,c(0,1/2,1:7),include.lowest = T)
cmdb$shTimeN <- gsub('^\\[|^\\(|,.*$','',cmdb$shTimeN)
# S3. Label for each server
cmdb$dClass <- ''
class_C <- 'C1'
class_B <- c('B5','B6','B1')
class_TS <- c('TS1','TS3','TS4','TS5','TS6')
cmdb$dClass[cmdb$dev_class_id %in% class_C] <- 'C'
cmdb$dClass[cmdb$dev_class_id %in% class_B] <- 'B'
cmdb$dClass[cmdb$dev_class_id %in% class_TS] <- 'TS'
# Data prepare for sc16
rm(list = ls())
source('head.R')
#@@@ CONFIGURE @@@#
load(file.path(dir_dataSource,'load_ftr_attrid.Rda'))
useOld <- 1
if (useOld == 1){
lowerTime <- as.POSIXct('2013-01-01')
upperTime <- as.POSIXct('2013-10-01')
saveName <- 'dataPrepareAFR13.Rda'
# lowerTime <- as.POSIXct('2013-06-01')
# upperTime <- as.POSIXct('2013-08-01')
# saveName <- 'dataPrepareAFR1306_1307.Rda'
}else{
lowerTime <- as.POSIXct('2014-06-01')
upperTime <- as.POSIXct('2014-08-01')
saveName <- 'dataPrepareAFR1406_1407.Rda'
}
# S1. Failure record prepare
data.f <- subset(data.flist, f_time < upperTime & f_time > lowerTime)
data.f <- subset(data.f,ip %in% cmdb$ip & svr_id %in% cmdb$svr_asset_id)
data.f$failShiptime <- as.numeric(difftime(data.f$f_time,data.f$use_time,tz = 'UTC',units = 'days'))/365
data.f$fsTime <- floor(data.f$failShiptime)
data.f$fsTimeN <- cut(data.f$failShiptime,c(0,1/2,1:7),include.lowest = T)
data.f$fsTimeN <- gsub('^\\[|^\\(|,.*$','',data.f$fsTimeN)
# S2. Compute online time for cmdb
cmdb$shiptimeToLeft <- as.numeric(difftime(lowerTime,cmdb$use_time,tz = 'UTC',units = 'days'))/365
cmdb$shiptimeToRight <- as.numeric(difftime(upperTime,cmdb$use_time,tz = 'UTC',units = 'days'))/365
cmdb$shTime <- floor(cmdb$shiptimeToRight)
cmdb$shTimeN <- cut(cmdb$shiptimeToRight,c(0,1/2,1:7),include.lowest = T)
cmdb$shTimeN <- gsub('^\\[|^\\(|,.*$','',cmdb$shTimeN)
# S3. Label for each server
cmdb$dClass <- ''
class_C <- 'C1'
class_B <- c('B5','B6','B1')
class_TS <- c('TS1','TS3','TS4','TS5','TS6')
cmdb$dClass[cmdb$dev_class_id %in% class_C] <- 'C'
cmdb$dClass[cmdb$dev_class_id %in% class_B] <- 'B'
cmdb$dClass[cmdb$dev_class_id %in% class_TS] <- 'TS'
# Data prepare for sc16
rm(list = ls())
source('head.R')
#@@@ CONFIGURE @@@#
load(file.path(dir_dataSource,'load_ftr_attrid.Rda'))
useOld <- 1
if (useOld == 1){
lowerTime <- as.POSIXct('2013-01-01')
upperTime <- as.POSIXct('2013-10-01')
saveName <- 'dataPrepareAFR13.Rda'
# lowerTime <- as.POSIXct('2013-06-01')
# upperTime <- as.POSIXct('2013-08-01')
# saveName <- 'dataPrepareAFR1306_1307.Rda'
}else{
lowerTime <- as.POSIXct('2014-06-01')
upperTime <- as.POSIXct('2014-08-01')
saveName <- 'dataPrepareAFR1406_1407.Rda'
}
# S1. Failure record prepare
data.f <- subset(data.flist, f_time < upperTime & f_time > lowerTime)
data.f <- subset(data.f,ip %in% cmdb$ip & svr_id %in% cmdb$svr_asset_id)
data.f$failShiptime <- as.numeric(difftime(data.f$f_time,data.f$use_time,tz = 'UTC',units = 'days'))/365
data.f$fsTime <- floor(data.f$failShiptime)
data.f$fsTimeN <- cut(data.f$failShiptime,c(0,1/2,1:7),include.lowest = T)
data.f$fsTimeN <- gsub('^\\[|^\\(|,.*$','',data.f$fsTimeN)
# S2. Compute online time for cmdb
cmdb$shiptimeToLeft <- as.numeric(difftime(lowerTime,cmdb$use_time,tz = 'UTC',units = 'days'))/365
cmdb$shiptimeToRight <- as.numeric(difftime(upperTime,cmdb$use_time,tz = 'UTC',units = 'days'))/365
cmdb$shTime <- floor(cmdb$shiptimeToRight)
cmdb$shTimeN <- cut(cmdb$shiptimeToRight,c(0,1/2,1:7),include.lowest = T)
cmdb$shTimeN <- gsub('^\\[|^\\(|,.*$','',cmdb$shTimeN)
# S3. Label for each server
cmdb$dClass <- ''
class_C <- 'C1'
class_B <- c('B5','B6','B1')
class_TS <- c('TS1','TS3','TS4','TS5','TS6')
cmdb$dClass[cmdb$dev_class_id %in% class_C] <- 'C'
cmdb$dClass[cmdb$dev_class_id %in% class_B] <- 'B'
cmdb$dClass[cmdb$dev_class_id %in% class_TS] <- 'TS'
cmdb <- mchAttr(cmdb,disk_ip,'svr_asset_id','svr_id',c('numDisk','numModel','numMain','mainModel'))
colcmdb <- c('svr_asset_id','ip','dev_class_id','bs1','shiptimeToLeft',
'shiptimeToRight','shTime','numDisk','numModel','numMain','mainModel')
table(disk_ip$numDisk)
cmdbio <- subset(cmdb,svr_asset_id %in% mean_io$svrid &
dev_class_id %in% c(class_C,class_TS) &
shiptimeToRight > 0 &
!is.na(numDisk),colcmdb)
cmdb <- mchAttr(cmdb,disk_ip,'svr_asset_id','svr_id',c('numDisk','numModel','numMain','mainModel'))
colcmdb <- c('svr_asset_id','ip','dev_class_id','bs1','shiptimeToLeft',
'shiptimeToRight','shTime','numDisk','numModel','numMain','mainModel')
cmdbio <- subset(cmdb,svr_asset_id %in% mean_io$svrid &
dev_class_id %in% c(class_C,class_TS) &
shiptimeToRight > 0 &
!is.na(numDisk),colcmdb)
data.fio <- mchAttr(data.fio,disk_ip,'svr_id','svr_id',c('numDisk','numModel','numMain','mainModel'))
data.fio <- mchAttr(data.f,disk_ip,'svr_id','svr_id',c('numDisk','numModel','numMain','mainModel'))
source(file.path(dir_code,'sc16F1Func.R'))
staLab <- ioAFR(cmdbio,data.fio,c('numDisk','mainModel'))
data.fio <- mchAttr(data.f,disk_ip,'svr_id','svr_id',c('numDisk','numModel','numMain','mainModel'))
View(data.fio)
summary(data.fio)
data.fio <- subset(data.fio,!is.na(numDisk))
summary(cmdbio$numMain)
summary(cmdbio)
source(file.path(dir_code,'sc16F1Func.R'))
staLab <- ioAFR(cmdbio,data.fio,c('numDisk','mainModel'))
io <- cmdbio;
f <- data.fio
attr <- c('numDisk','mainModel')
t1 <- melt(table(io[,attr]),value.name = attr)
attr
source('~/Code/R/attrid/sc16F1Func.R')
staLab <- ioAFR(cmdbio,data.fio,c('numDisk','mainModel'))
t1 <- melt(table(io[,attr]),value.name = c(attr,'value'))
t1 <- melt(table(io[,attr]))
t2 <- melt(table(f[,attr]))
source('~/Code/R/attrid/sc16F1Func.R')
staLab <- ioAFR(cmdbio,data.fio,c('numDisk','mainModel'))
View(staLab)
staLab <- subset(staLab,count > 10)
staLab <- staLab[order(staLab$count,decreasing = T),]
View(staLab)
staLab <- subset(staLab,mainModel %in% modelNeed)
modelNeed <- c('ST3500514NS','ST31000524NS','ST32000645NS',
'ST500NM0011','ST1000NM0011','ST2000NM0011')
staLab <- subset(staLab,mainModel %in% modelNeed)
View(staLab)
cmdbio <- subset(cmdbio,mainModel %in% modelNeed)
cmdbio <- factorX(subset(cmdbio,mainModel %in% modelNeed))
cmdbio <- subset(cmdb,svr_asset_id %in% mean_io$svrid &
dev_class_id %in% c(class_C,class_TS) &
shiptimeToRight > 0 &
!is.na(numDisk),colcmdb)
data.fio <- mchAttr(data.f,disk_ip,'svr_id','svr_id',c('numDisk','numModel','numMain','mainModel'))
data.fio <- subset(data.fio,!is.na(numDisk))
source(file.path(dir_code,'sc16F1Func.R'))
staLab <- ioAFR(cmdbio,data.fio,c('numDisk','mainModel'))
staLab <- subset(staLab,count > 10)
staLab <- staLab[order(staLab$count,decreasing = T),]
modelNeed <- c('ST3500514NS','ST31000524NS','ST32000645NS',
'ST500NM0011','ST1000NM0011','ST2000NM0011')
staLab <- subset(staLab,mainModel %in% modelNeed)
cmdbio$tagDisk <- 'A'
cmdbio$tagDisk[cmdbio$numModel >= 6] <- 'B'
cmdbio <- factorX(subset(cmdbio,mainModel %in% modelNeed))
cmdbio$tagDisk <-
'A'
cmdbio$tagDisk <- 'A'
cmdbio$tagDisk[cmdbio$numModel >= 6] <- 'B'
cmdbio <- factorX(subset(cmdbio,mainModel %in% modelNeed))
cmdbio$tagDisk <- paste(cmdbio$tagDisk,cmdbio$mainModel,sep='-')
cmdbio$tagDisk <- 'A'
cmdbio$tagDisk[cmdbio$numModel >= 6] <- 'B'
cmdbio <- factorX(subset(cmdbio,mainModel %in% modelNeed))
cmdbio$tagDisk <- paste(cmdbio$tagDisk,cmdbio$mainModel,sep='-')
source('~/Code/R/attrid/dataPrepareAFR.R')
source('~/Code/R/attrid/dataPrepareAFR.R')
source('~/Code/R/attrid/dataPrepareAFR.R')
source('~/Code/R/attrid/dataPrepareAFR.R')
rm(list = ls())
source('head.R')
load(file.path(dir_data,'dataPrepareAFR13.Rda'))
rm(list = ls())
source('head.R')
load(file.path(dir_data,'dataPrepareAFR13.Rda'))
table(tmp.cmdb$tagDisk)
source('~/Code/R/attrid/dataPrepareAFR.R')
source('~/Code/R/attrid/dataPrepareAFR.R')
source('~/Code/R/attrid/dataPrepareAFR.R')
timeWindow <- 2
source('~/Code/R/attrid/dataPrepareAFR.R')
timeWindow <- 0
source('~/Code/R/attrid/dataPrepareAFR.R')
rm(list = ls())
source('head.R')
library(ggplot2)
lowerTime <- as.POSIXct('2013-07-01')
upperTime <- as.POSIXct('2013-09-01')
saveName <- 'dataPrepareAFR1307_1308.Rda'
data.f <- subset(data.flist, f_time < upperTime & f_time > lowerTime)
# Data prepare for sc16
rm(list = ls())
source('head.R')
library(ggplot2)
#@@@ CONFIGURE @@@#
load(file.path(dir_dataSource,'load_ftr_attrid.Rda'))
#test
lowerTime <- as.POSIXct('2013-07-01')
upperTime <- as.POSIXct('2013-09-01')
saveName <- 'dataPrepareAFR1307_1308.Rda'
data.f <- subset(data.flist, f_time < upperTime & f_time > lowerTime)
data.f <- subset(data.f,ip %in% cmdb$ip & svr_id %in% cmdb$svr_asset_id)
data.f$failShiptime <- as.numeric(difftime(data.f$f_time,data.f$use_time,tz = 'UTC',units = 'days'))/365
data.f$fsTime <- floor(data.f$failShiptime)
data.f$fsTimeN <- cut(data.f$failShiptime,c(0,1/2,1:7),include.lowest = T)
data.f$fsTimeN <- gsub('^\\[|^\\(|,.*$','',data.f$fsTimeN)
# S2. Compute online time for cmdb
cmdb$shiptimeToLeft <- as.numeric(difftime(lowerTime,cmdb$use_time,tz = 'UTC',units = 'days'))/365
cmdb$shiptimeToRight <- as.numeric(difftime(upperTime,cmdb$use_time,tz = 'UTC',units = 'days'))/365
quantileX(cmdb$shiptimeToLeft)
a <- subset(cmdb,shiptimeToLeft < 0)
quantile(a$use_time)
lowerTime
cmdb <- subset(cmdb,use_time <= upperTime)
quantileX(cmdb$shiptimeToRight)
source('~/Code/R/attrid/dataPrepareAFR.R')
dataPrepare(as.POSIXct('2013-01-01'),as.POSIXct('2013-07-01'),'dataPrepareAFR13A.Rda')
dataPrepare(as.POSIXct('2013-07-01'),as.POSIXct('2014-01-01'),'dataPrepareAFR13B.Rda')
dataPrepare(as.POSIXct('2014-01-01'),as.POSIXct('2014-07-01'),'dataPrepareAFR14A.Rda')
dataPrepare(as.POSIXct('2014-07-01'),as.POSIXct('2015-01-01'),'dataPrepareAFR14B.Rda')
