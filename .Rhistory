x <- data$a902[data$svrid == sid]
x <- x[x <= quantile(x,0.99)]
x[x < 0] <- 0
N <- length(x);n <- 0:(N-1);t <- n/fs;
f <- n*fs/N;fft <- abs(fft(x))
f <- f[2:(N/2)];fft <- fft[2:(N/2)]
dataV <- data.frame(time = 1:length(x),x)
dataF <- data.frame(freq = f,fft)
p1 <- ggplot(dataV,aes(x = time,y = x)) + geom_line()
p2 <- ggplot(dataF,aes(x = freq,y = fft)) + geom_line(stat = 'identity')
multiplot(p1,p2,cols = 2)
dataF <- dataF[order(dataF$fft,decreasing = T),];
1/dataF$freq[1:5]/86400
}
svrid <- levels(data$svrid)
mtplot(svrid[14])
mtplot(svrid[15])
a <- subset(data,svrid == svrid[15])
View(a)
a <- subset(data,svrid == svrid[15] & a902 != 0)
View(a)
a <- subset(data,svrid == svrid[15] & a902 > 5)
View(a)
View(a)
a <- subset(data,svrid == svrid[15] & a902 > 500)
View(a)
mtplot <- function(sid){
x <- data$a902[data$svrid == sid]
x <- x[x <= quantile(x,0.99)]
x[x < 0] <- 0
N <- length(x);n <- 0:(N-1);t <- n/fs;
f <- n*fs/N;fft <- abs(fft(x))
f <- f[2:(N/2)];fft <- fft[2:(N/2)]
dataV <- data.frame(time = 1:length(x),x)
dataF <- data.frame(freq = f,fft)
p1 <- ggplot(dataV,aes(x = time,y = x)) + geom_line() + ggtitle(sid)
p2 <- ggplot(dataF,aes(x = freq,y = fft)) + geom_line(stat = 'identity')
multiplot(p1,p2,cols = 2)
dataF <- dataF[order(dataF$fft,decreasing = T),];
1/dataF$freq[1:5]/86400
}
svrid <- levels(data$svrid)
mtplot(svrid[15])
a <- subset(data,svrid == svrid[15] & a902 > 500)
View(a)
svrid[15]]
svrid[15]
data$svrid[15]
sid <- levels(data$svrid)
mtplot(sid[15])
View(a)
a <- subset(data,svrid == svrid[15] & a902 > 500)
View(a)
a <- subset(data,svrid == sid[15] & a902 > 500)
View(a)
a <- subset(data,svrid == sid[15])
View(a)
mtplot(sid[16])
mtplot <- function(sid){
x <- data$a902[data$svrid == sid]
x <- x[x <= quantile(x,0.99)]
x[x < 0] <- 0
N <- length(x);n <- 0:(N-1);t <- n/fs;
f <- n*fs/N;fft <- abs(fft(x))
f <- f[2:(N/2)];fft <- fft[2:(N/2)]
dataV <- data.frame(time = 1:length(x),x)
dataF <- data.frame(freq = f,fft)
p1 <- ggplot(dataV,aes(x = time,y = x)) + geom_line() + ggtitle(sid)
p2 <- ggplot(dataF,aes(x = freq,y = fft)) + geom_line(stat = 'identity')
multiplot(p1,p2,cols = 2)
dataF <- dataF[order(dataF$fft,decreasing = T),];
1/dataF$freq[1:5]/86400
return(list(dataV,dataF))
}
sid <- levels(data$svrid)
[rV rF] <- mtplot(sid[16])
c(rV,rF) <- mtplot(sid[16])
list(rV,rF) <- mtplot(sid[16])
list[rV,rF] <- mtplot(sid[16])
source(file.path(dir_code,'attr_function.R'))
list[rV,rF] <- mtplot(sid[16])
View(rV)
View(rF)
mtplot <- function(sid){
x <- data$a902[data$svrid == sid]
x <- x[x <= quantile(x,0.99)]
x[x < 0] <- 0
N <- length(x);n <- 0:(N-1);t <- n/fs;
f <- n*fs/N;fft <- abs(fft(x))
f <- f[2:(N/2)];fft <- fft[2:(N/2)]
dataV <- data.frame(time = 1:length(x),x)
dataF <- data.frame(freq = f,fft)
p1 <- ggplot(dataV,aes(x = time,y = x)) + geom_line() + ggtitle(sid)
p2 <- ggplot(dataF,aes(x = freq,y = fft)) + geom_line(stat = 'identity')
multiplot(p1,p2,cols = 2)
dataF <- dataF[order(dataF$fft,decreasing = T),];
dataF$days <- 1/dataF$freq/86400
dataF$days[1:5]
return(list(dataV,dataF))
}
sid <- levels(data$svrid)
list[rV,rF] <- mtplot(sid[16])
mtplot <- function(sid){
x <- data$a902[data$svrid == sid]
x <- x[x <= quantile(x,0.99)]
x[x < 0] <- 0
N <- length(x);n <- 0:(N-1);t <- n/fs;
f <- n*fs/N;fft <- abs(fft(x))
f <- f[2:(N/2)];fft <- fft[2:(N/2)]
dataV <- data.frame(time = 1:length(x),x)
dataF <- data.frame(freq = f,fft)
p1 <- ggplot(dataV,aes(x = time,y = x)) + geom_line() + ggtitle(sid)
p2 <- ggplot(dataF,aes(x = freq,y = fft)) + geom_line(stat = 'identity')
multiplot(p1,p2,cols = 2)
dataF <- dataF[order(dataF$fft,decreasing = T),];
dataF$days <- 1/dataF$freq/86400
print(dataF$days[1:5])
return(list(dataV,dataF))
}
sid <- levels(data$svrid)
list[rV,rF] <- mtplot(sid[16])
mtplot <- function(sid){
x <- subset(data,svrid == sid,c('a902','timeNew'))
names(x) <- c('value','time')
x <- x[x$value <= quantile(x$value,0.99)]
x$value[x$value < 0] <- 0
N <- length(x$value);n <- 0:(N-1);t <- n/fs;
f <- n*fs/N;fft <- abs(fft(x$value))
f <- f[2:(N/2)];fft <- fft[2:(N/2)]
dataV <- data.frame(time = x$time,value = x$value)
dataF <- data.frame(freq = f,fft)
p1 <- ggplot(dataV,aes(x = time,y = value)) + geom_line() + ggtitle(sid)
p2 <- ggplot(dataF,aes(x = freq,y = fft)) + geom_line(stat = 'identity')
multiplot(p1,p2,cols = 2)
dataF <- dataF[order(dataF$fft,decreasing = T),];
dataF$days <- 1/dataF$freq/86400
print(dataF$days[1:5])
return(list(dataV,dataF))
}
sid <- levels(data$svrid)
list[rV,rF] <- mtplot(sid[16])
sid <= sid[1]
sid <- sid[1]
x <- subset(data,svrid == sid,c('a902','timeNew'))
names(x) <- c('value','time')
x <- x[x$value <= quantile(x$value,0.99)]
x <- x[x$value <= quantile(x$value,0.99),]
x$value[x$value < 0] <- 0
N <- length(x$value);n <- 0:(N-1);t <- n/fs;
f <- n*fs/N;fft <- abs(fft(x$value))
f <- f[2:(N/2)];fft <- fft[2:(N/2)]
dataV <- data.frame(time = x$time,value = x$value)
dataF <- data.frame(freq = f,fft)
p1 <- ggplot(dataV,aes(x = time,y = value)) + geom_line() + ggtitle(sid)
p2 <- ggplot(dataF,aes(x = freq,y = fft)) + geom_line(stat = 'identity')
multiplot(p1,p2,cols = 2)
dataF <- dataF[order(dataF$fft,decreasing = T),];
dataF$days <- 1/dataF$freq/86400
print(dataF$days[1:5])
mtplot <- function(sid){
x <- subset(data,svrid == sid,c('a902','timeNew'))
names(x) <- c('value','time')
x <- x[x$value <= quantile(x$value,0.99),]
x$value[x$value < 0] <- 0
N <- length(x$value);n <- 0:(N-1);t <- n/fs;
f <- n*fs/N;fft <- abs(fft(x$value))
f <- f[2:(N/2)];fft <- fft[2:(N/2)]
dataV <- data.frame(time = x$time,value = x$value)
dataF <- data.frame(freq = f,fft)
p1 <- ggplot(dataV,aes(x = time,y = value)) + geom_line() + ggtitle(sid)
p2 <- ggplot(dataF,aes(x = freq,y = fft)) + geom_line(stat = 'identity')
multiplot(p1,p2,cols = 2)
dataF <- dataF[order(dataF$fft,decreasing = T),];
dataF$days <- 1/dataF$freq/86400
print(dataF$days[1:5])
return(list(dataV,dataF))
}
sid <- levels(data$svrid)
list[rV,rF] <- mtplot(sid[16])
View(rF)
sid <- levels(data$svrid)
list[rV,rF] <- mtplot(sid[17])
View(rF)
list[rV,rF] <- mtplot(sid[18])
list[rV,rF] <- mtplot(sid[18])
list[rV,rF] <- mtplot(sid[18])
View(rF)
mtplot <- function(sid){
x <- subset(data,svrid == sid,c('a902','timeNew'))
names(x) <- c('value','time')
x <- x[x$value <= quantile(x$value,0.99),]
x$value[x$value < 0] <- 0
N <- length(x$value);n <- 0:(N-1);t <- n/fs;
f <- n*fs/N;fft <- abs(fft(x$value))
f <- f[2:(N/2)];fft <- fft[2:(N/2)]
dataV <- data.frame(time = x$time,value = x$value)
dataF <- data.frame(freq = f,fft)
p1 <- ggplot(dataV,aes(x = time,y = value)) + geom_line() + ggtitle(sid)
p2 <- ggplot(dataF,aes(x = freq,y = fft)) + geom_line(stat = 'identity')
multiplot(p1,p2,cols = 2)
dataF <- dataF[order(dataF$fft,decreasing = T),];
dataF$days <- 1/dataF$freq/86400
print(dataF$days[1:5])
dataF$round <- round(dataF$round)
dataF$absR <- abs(dataF$days - dataF$round)
return(list(dataV,dataF))
}
sid <- levels(data$svrid)
list[rV,rF] <- mtplot(sid[18])
View(rF)
View(rF)
mtplot <- function(sid){
x <- subset(data,svrid == sid,c('a902','timeNew'))
names(x) <- c('value','time')
x <- x[x$value <= quantile(x$value,0.99),]
x$value[x$value < 0] <- 0
N <- length(x$value);n <- 0:(N-1);t <- n/fs;
f <- n*fs/N;fft <- abs(fft(x$value))
f <- f[2:(N/2)];fft <- fft[2:(N/2)]
dataV <- data.frame(time = x$time,value = x$value)
dataF <- data.frame(freq = f,fft)
p1 <- ggplot(dataV,aes(x = time,y = value)) + geom_line() + ggtitle(sid)
p2 <- ggplot(dataF,aes(x = freq,y = fft)) + geom_line(stat = 'identity')
multiplot(p1,p2,cols = 2)
dataF <- dataF[order(dataF$fft,decreasing = T),];
dataF$days <- 1/dataF$freq/86400
print(dataF$days[1:5])
dataF$round <- round(dataF$days)
dataF$absR <- abs(dataF$days - dataF$round)
return(list(dataV,dataF))
}
sid <- levels(data$svrid)
list[rV,rF] <- mtplot(sid[18])
View(rF)
mtplot <- function(sid){
x <- subset(data,svrid == sid,c('a902','timeNew'))
names(x) <- c('value','time')
x <- x[x$value <= quantile(x$value,0.99),]
x$value[x$value < 0] <- 0
N <- length(x$value);n <- 0:(N-1);t <- n/fs;
f <- n*fs/N;fft <- abs(fft(x$value))
f <- f[2:(N/2)];fft <- fft[2:(N/2)]
dataV <- data.frame(time = x$time,value = x$value)
dataF <- data.frame(freq = f,fft)
p1 <- ggplot(dataV,aes(x = time,y = value)) + geom_line() + ggtitle(sid)
p2 <- ggplot(dataF,aes(x = freq,y = fft)) + geom_line(stat = 'identity')
multiplot(p1,p2,cols = 2)
dataF <- dataF[order(dataF$fft,decreasing = T),];
dataF$days <- 1/dataF$freq/86400
print(dataF$days[1:5])
dataF$round <- round(dataF$days)
dataF$absR <- abs(dataF$days - dataF$round)
dataF$readPediod <- dataF$absR <= 0.05
return(list(dataV,dataF))
}
sid <- levels(data$svrid)
list[rV,rF] <- mtplot(sid[18])
View(rF)
mtplot <- function(sid){
x <- subset(data,svrid == sid,c('a902','timeNew'))
names(x) <- c('value','time')
x <- x[x$value <= quantile(x$value,0.99),]
x$value[x$value < 0] <- 0
N <- length(x$value);n <- 0:(N-1);t <- n/fs;
f <- n*fs/N;fft <- abs(fft(x$value))
f <- f[2:(N/2)];fft <- fft[2:(N/2)]
dataV <- data.frame(time = x$time,value = x$value)
dataF <- data.frame(freq = f,fft)
p1 <- ggplot(dataV,aes(x = time,y = value)) + geom_line() + ggtitle(sid)
p2 <- ggplot(dataF,aes(x = freq,y = fft)) + geom_line(stat = 'identity')
multiplot(p1,p2,cols = 2)
dataF <- dataF[order(dataF$fft,decreasing = T),];
dataF$days <- 1/dataF$freq/86400
print(dataF$days[1:5])
dataF$round <- round(dataF$days)
dataF$absR <- abs(dataF$days - dataF$round)
dataF$readPediod <- dataF$absR <= 0.05
dataF <- subset(dataF,days > 1/24 & days < 10)
return(list(dataV,dataF))
}
sid <- levels(data$svrid)
list[rV,rF] <- mtplot(sid[18])
View(rF)
View(rF)
mtplot <- function(sid){
x <- subset(data,svrid == sid,c('a902','timeNew'))
names(x) <- c('value','time')
x <- x[x$value <= quantile(x$value,0.99),]
x$value[x$value < 0] <- 0
N <- length(x$value);n <- 0:(N-1);t <- n/fs;
f <- n*fs/N;fft <- abs(fft(x$value))
f <- f[2:(N/2)];fft <- fft[2:(N/2)]
dataV <- data.frame(time = x$time,value = x$value)
dataF <- data.frame(freq = f,fft)
p1 <- ggplot(dataV,aes(x = time,y = value)) + geom_line() + ggtitle(sid)
p2 <- ggplot(dataF,aes(x = freq,y = fft)) + geom_line(stat = 'identity')
multiplot(p1,p2,cols = 2)
dataF <- dataF[order(dataF$fft,decreasing = T),];
dataF$days <- 1/dataF$freq/86400
print(dataF$days[1:5])
dataF$round <- round(dataF$days)
dataF$absR <- abs(dataF$days - dataF$round)
dataF$readPediod <- dataF$absR <= 0.05
dataF <- subset(dataF,days > 1/3 & days < 10)
return(list(dataV,dataF))
}
sid <- levels(data$svrid)
list[rV,rF] <- mtplot(sid[18])
View(rF)
list[rV,rF] <- mtplot(sid[19])
View(rF)
list[rV,rF] <- mtplot(sid[20])
View(rF)
mtplot <- function(sid){
x <- subset(data,svrid == sid,c('a902','timeNew'))
names(x) <- c('value','time')
x <- x[x$value <= quantile(x$value,0.99),]
x$value[x$value < 0] <- 0
N <- length(x$value);n <- 0:(N-1);t <- n/fs;
f <- n*fs/N;fft <- abs(fft(x$value))
f <- f[2:(N/2)];fft <- fft[2:(N/2)]
dataV <- data.frame(time = x$time,value = x$value)
dataF <- data.frame(freq = f,fft)
p1 <- ggplot(dataV,aes(x = time,y = value)) + geom_line() + ggtitle(sid)
p2 <- ggplot(dataF,aes(x = freq,y = fft)) + geom_line(stat = 'identity')
multiplot(p1,p2,cols = 2)
dataF <- dataF[order(dataF$fft,decreasing = T),];
dataF$days <- 1/dataF$freq/86400
print(dataF$days[1:5])
dataF$round <- round(dataF$days)
dataF$absR <- abs(dataF$days - dataF$round)
dataF$realPeriod <- dataF$absR <= 0.05
dataF <- subset(dataF,days > 1/3 & days < 10 & realPeriod == T)
return(list(dataV,dataF))
}
sid <- levels(data$svrid)
list[rV,rF] <- mtplot(sid[20])
View(rF)
list[rV,rF] <- mtplot(sid[21])
list[rV,rF] <- mtplot(sid[21]);print(rF[1:5,])
View(rV)
summary(rV)
View(rF)
View(rF)
list[rV,rF] <- mtplot(sid[21]);print(rF[1:5,])
View(rF)
mtplot <- function(sid){
x <- subset(data,svrid == sid,c('a902','timeNew'))
names(x) <- c('value','time')
x <- x[x$value <= quantile(x$value,0.99),]
x$value[x$value < 0] <- 0
N <- length(x$value);n <- 0:(N-1);t <- n/fs;
f <- n*fs/N;fft <- abs(fft(x$value))
f <- f[2:(N/2)];fft <- fft[2:(N/2)]
dataV <- data.frame(time = x$time,value = x$value)
dataF <- data.frame(freq = f,fft)
p1 <- ggplot(dataV,aes(x = time,y = value)) + geom_line() + ggtitle(sid)
p2 <- ggplot(dataF,aes(x = freq,y = fft)) + geom_line(stat = 'identity')
multiplot(p1,p2,cols = 2)
dataF <- dataF[order(dataF$fft,decreasing = T),];
dataF$days <- 1/dataF$freq/86400
dataF$round <- round(dataF$days)
dataF$absR <- abs(dataF$days - dataF$round)
dataF$realPeriod <- dataF$absR <= 0.05
dataFS <- subset(dataF,days > 1/3 & days < 10 & realPeriod == T)
return(list(dataV,dataFS,dataF))
}
sid <- levels(data$svrid)
list[rV,rFS,rF] <- mtplot(sid[21]);print(rFS[1:5,])
View(rFS)
View(rF)
mtplot <- function(sid){
x <- subset(data,svrid == sid,c('a902','timeNew'))
names(x) <- c('value','time')
x <- x[x$value <= quantile(x$value,0.99),]
x$value[x$value < 0] <- 0
N <- length(x$value);n <- 0:(N-1);t <- n/fs;
f <- n*fs/N;fft <- abs(fft(x$value))
f <- f[2:(N/2)];fft <- fft[2:(N/2)]
dataV <- data.frame(time = x$time,value = x$value)
dataF <- data.frame(freq = f,fft)
p1 <- ggplot(dataV,aes(x = time,y = value)) + geom_line() + ggtitle(sid)
p2 <- ggplot(dataF,aes(x = freq,y = fft)) + geom_line(stat = 'identity')
multiplot(p1,p2,cols = 2)
dataF <- dataF[order(dataF$fft,decreasing = T),];
dataF$days <- 1/dataF$freq/86400
dataF$round <- round(dataF$days)
dataF$absR <- abs(dataF$days - dataF$round)
dataF$realPeriod <- dataF$absR <= 0.05
dataFS <- subset(dataF,days > 1/3 & days < 10 & fft > 0 & realPeriod == T)
return(list(dataV,dataFS,dataF))
}
sid <- levels(data$svrid)
list[rV,rFS,rF] <- mtplot(sid[21]);print(rFS[1:5,])
list[rV,rFS,rF] <- mtplot(sid[22]);print(rFS[1:5,])
View(rV)
View(rF)
View(rFS)
View(rF)
list[rV,rFS,rF] <- mtplot(sid[21]);print(rFS[1:5,])
list[rV,rFS,rF] <- mtplot(sid[20]);print(rFS[1:5,])
list[rV,rFS,rF] <- mtplot(sid[1]);print(rFS[1:5,])
list[rV,rFS,rF] <- mtplot(sid[2]);print(rFS[1:5,])
View(rF)
list[rV,rFS,rF] <- mtplot(sid[3]);print(rFS[1:5,])
View(rFS)
View(rF)
list[rV,rFS,rF] <- mtplot(sid[3]);print(rFS[1:5,])
list[rV,rFS,rF] <- mtplot(sid[2]);print(rFS[1:5,])
View(rFS)
View(rF)
list[rV,rFS,rF] <- mtplot(sid[3]);print(rFS[1:5,])
list[rV,rFS,rF] <- mtplot(sid[3]);print(rFS[1:5,c('fft','round','absR')])
mtplot <- function(sid){
x <- subset(data,svrid == sid,c('a902','timeNew'))
names(x) <- c('value','time')
x <- x[x$value <= quantile(x$value,0.99),]
x$value[x$value < 0] <- 0
N <- length(x$value);n <- 0:(N-1);t <- n/fs;
f <- n*fs/N;fft <- abs(fft(x$value))
f <- f[2:(N/2)];fft <- fft[2:(N/2)]
dataV <- data.frame(time = x$time,value = x$value)
dataF <- data.frame(freq = f,fft)
p1 <- ggplot(dataV,aes(x = time,y = value)) + geom_line() + ggtitle(sid)
p2 <- ggplot(dataF,aes(x = freq,y = fft)) + geom_line(stat = 'identity')
multiplot(p1,p2,cols = 2)
dataF <- dataF[order(dataF$fft,decreasing = T),];
dataF$days <- 1/dataF$freq/86400
dataF$round <- round(dataF$days)
dataF$absR <- abs(dataF$days - dataF$round)
dataF$realPeriod <- dataF$absR <= 0.05
dataF$fftRate <- dataF$fft/sum(dataF$fft)
dataFS <- subset(dataF,days > 1/3 & days < 10 & fft > 0 & realPeriod == T)
return(list(dataV,dataFS,dataF))
}
sid <- levels(data$svrid)
list[rV,rFS,rF] <- mtplot(sid[3]);print(rFS[1:5,c('fft','round','absR')])
mtplot <- function(sid){
x <- subset(data,svrid == sid,c('a902','timeNew'))
names(x) <- c('value','time')
x <- x[x$value <= quantile(x$value,0.99),]
x$value[x$value < 0] <- 0
N <- length(x$value);n <- 0:(N-1);t <- n/fs;
f <- n*fs/N;fft <- abs(fft(x$value))
f <- f[2:(N/2)];fft <- fft[2:(N/2)]
dataV <- data.frame(time = x$time,value = x$value)
dataF <- data.frame(freq = f,fft)
p1 <- ggplot(dataV,aes(x = time,y = value)) + geom_line() + ggtitle(sid)
p2 <- ggplot(dataF,aes(x = freq,y = fft)) + geom_line(stat = 'identity')
multiplot(p1,p2,cols = 2)
dataF <- dataF[order(dataF$fft,decreasing = T),];
dataF$days <- 1/dataF$freq/86400
dataF$round <- round(dataF$days)
dataF$absR <- abs(dataF$days - dataF$round)
dataF$realPeriod <- dataF$absR <= 0.05
dataF$fftRate <- dataF$fft/sum(dataF$fft)*100
dataFS <- subset(dataF,days > 1/3 & days < 10 & fft > 0 & realPeriod == T)
return(list(dataV,dataFS,dataF))
}
sid <- levels(data$svrid)
list[rV,rFS,rF] <- mtplot(sid[3]);print(rFS[1:5,c('fft','round','absR','fftRate')])
list[rV,rFS,rF] <- mtplot(sid[2]);print(rFS[1:5,c('fft','round','fftRate','absR')])
list[rV,rFS,rF] <- mtplot(sid[3]);print(rFS[1:5,c('fft','round','fftRate','absR')])
list[rV,rFS,rF] <- mtplot(sid[4]);print(rFS[1:5,c('fft','round','fftRate','absR')])
list[rV,rFS,rF] <- mtplot(sid[5]);print(rFS[1:5,c('fft','round','fftRate','absR')])
list[rV,rFS,rF] <- mtplot(sid[6]);print(rFS[1:5,c('fft','round','fftRate','absR')])
xs <- seq(-2*pi,2*pi,pi/100)
wave.1 <- sin(3*xs)
wave.2 <- sin(10*xs)
par(mfrow = c(1, 2))
plot(xs,wave.1,xs,wave.2)
plot(xs,wave.1)
plot(xs,wave.1)
plot(xs,wave.1)
plot(xs,wave.1)
str(plot)
ggplot(data.frame(xs,wave.1),aes(x = xs,y = wave.1)) + geom_point()
ggplot(data.frame(xs,wave.1),aes(x = xs,y = wave.1)) + geom_line()
ggplot(data.frame(xs,wave.1),aes(x = xs,y = wave.1)) + geom_bar()
ggplot(data.frame(xs,wave.1),aes(x = xs,y = wave.1)) + geom_bar(stat = 'identity')
plot(xs,wave.1,type="l",ylim=c(-1,1));
abline(h=0,lty=3)
wave.3 <- 0.5 * wave.1 + 0.25 * wave.2
plot(xs,wave.3,type="l"); title("Eg complex wave"); abline(h=0,lty=3)
wave.4 <- wave.3
wave.4[wave.3>0.5] <- 0.5
plot(xs,wave.4,type="l",ylim=c(-1.25,1.25)); title("overflowed, non-linear complex wave"); abline(h=0,lty=3)
repeat.xs     <- seq(-2*pi,0,pi/100)
wave.3.repeat <- 0.5*sin(3*repeat.xs) + 0.25*sin(10*repeat.xs)
plot(xs,wave.3,type="l"); title("Repeating pattern")
points(repeat.xs,wave.3.repeat,type="l",col="red"); abline(h=0,v=c(-2*pi,0),lty=3)
plot(xs,wave.3,type="l"); title("Repeating pattern")\
plot(xs,wave.3,type="l"); title("Repeating pattern")
xs <- seq(-2*pi,2*pi,pi/100)
wave.1 <- sin(3*xs)
wave.2 <- sin(10*xs)
par(mfrow = c(1, 2))
plot(xs,wave.1,type="l",ylim=c(-1,1)); abline(h=0,lty=3)
plot(xs,wave.2,type="l",ylim=c(-1,1)); abline(h=0,lty=3)
wave.3 <- 0.5 * wave.1 + 0.25 * wave.2
plot(xs,wave.3,type="l"); title("Eg complex wave"); abline(h=0,lty=3)
wave.3 <- 0.5 * wave.1 + 0.25 * wave.2
plot(xs,wave.3,type="l"); title("Eg complex wave"); abline(h=0,lty=3)
wave.4 <- wave.3
wave.4[wave.3>0.5] <- 0.5
plot(xs,wave.4,type="l",ylim=c(-1.25,1.25)); title("overflowed, non-linear complex wave"); abline(h=0,lty=3)
repeat.xs     <- seq(-2*pi,0,pi/100)
wave.3.repeat <- 0.5*sin(3*repeat.xs) + 0.25*sin(10*repeat.xs)
plot(xs,wave.3,type="l"); title("Repeating pattern")
points(repeat.xs,wave.3.repeat,type="l",col="red"); abline(h=0,v=c(-2*pi,0),lty=3)
plot(xs,wave.3,type="l"); title("Repeating pattern")
points(repeat.xs,wave.3.repeat,type="l",col="red"); abline(h=0,v=c(-2*pi,0),lty=3)
