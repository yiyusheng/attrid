View(sta3)
sta3
a <- smp_df(splitA[[7]],100)
a <- smp_df(splitA[[8]],100)
a
a$faultInfo
a <- smp_df(splitA[[9]],100)
View(a)
a <- smp_df(splitA[[10]],100)
View(a)
a$faultInfo
a <- smp_df(splitA[[11]],100)
i <- fi[2]
df <- smp_df(subset(FT,fi_tag == i),20)
View(df)
fname <- list.files(dir_figure)
dir_figure <- file.path(dir_data,'plot_svrid_iops_2015')
fname <- list.files(dir_figure)
fname[1]
fname <- data.frame(fn = list.files(dir_figure));fname$svrid <- gsub('.*-|\\.png','',fname$fn)
View(fname)
file.path(dir_figure,fname$fn[fname$svrid %in% df$svrid])
i
prefix <- paste('tag',i,'-')
prefix
i = 1
df <- smp_df(subset(FT,fi_tag == fi[i]),20)
prefix <- paste('tag',i,'-')
prefix
prefix <- paste('tag',i,'-',sep='')
prefix
prefix <- paste('tag',i,'-',sep='')
fn_copy <- fname$fn[fname$svrid %in% df$svrid]
from_path <- file.path(dir_figure,fn_copy)
to_path <- file.path(dir_figure_examine,paste(prefix,fn_copy))
dir_figure_examine <- file.path(dir_data,'plot_svrid_iops_2015_check')
check_dir(dir_figure_examine)
fname <- data.frame(fn = list.files(dir_figure));fname$svrid <- gsub('.*-|\\.png','',fname$fn)
i = 1
df <- smp_df(subset(FT,fi_tag == fi[i]),20)
prefix <- paste('tag',i,'-',sep='')
fn_copy <- fname$fn[fname$svrid %in% df$svrid]
from_path <- file.path(dir_figure,fn_copy)
to_path <- file.path(dir_figure_examine,paste(prefix,fn_copy))
from_path
to_path
to_path <- file.path(dir_figure_examine,paste(prefix,fn_copy,sep=''))
to_path
dir_figure <- file.path(dir_data,'plot_svrid_iops_2015')
dir_figure_examine <- file.path(dir_data,'plot_svrid_iops_2015_check');check_dir(dir_figure_examine)
fname <- data.frame(fn = list.files(dir_figure));fname$svrid <- gsub('.*-|\\.png','',fname$fn)
r <- lappy(1:length(fi),function(i){
df <- smp_df(subset(FT,fi_tag == fi[i]),20)
prefix <- paste('tag',i,'-',sep='')
fn_copy <- fname$fn[fname$svrid %in% df$svrid]
from_path <- file.path(dir_figure,fn_copy)
to_path <- file.path(dir_figure_examine,paste(prefix,fn_copy,sep=''))
file.copy(from_path,to_path)
df
})
dir_figure <- file.path(dir_data,'plot_svrid_iops_2015')
dir_figure_examine <- file.path(dir_data,'plot_svrid_iops_2015_check');check_dir(dir_figure_examine)
fname <- data.frame(fn = list.files(dir_figure));fname$svrid <- gsub('.*-|\\.png','',fname$fn)
r <- lapply(1:length(fi),function(i){
df <- smp_df(subset(FT,fi_tag == fi[i]),20)
prefix <- paste('tag',i,'-',sep='')
fn_copy <- fname$fn[fname$svrid %in% df$svrid]
from_path <- file.path(dir_figure,fn_copy)
to_path <- file.path(dir_figure_examine,paste(prefix,fn_copy,sep=''))
file.copy(from_path,to_path)
df
})
r <- lapply(1:length(fi),function(i){
df <- smp_df(FT[fi_tag == fi[i],],20)
prefix <- paste('tag',i,'-',sep='')
fn_copy <- fname$fn[fname$svrid %in% df$svrid]
from_path <- file.path(dir_figure,fn_copy)
to_path <- file.path(dir_figure_examine,paste(prefix,fn_copy,sep=''))
file.copy(from_path,to_path)
df
})
r <- lapply(1:length(fi),function(i){
df <- smp_df(FT[FT$fi_tag == fi[i],],20)
prefix <- paste('tag',i,'-',sep='')
fn_copy <- fname$fn[fname$svrid %in% df$svrid]
from_path <- file.path(dir_figure,fn_copy)
to_path <- file.path(dir_figure_examine,paste(prefix,fn_copy,sep=''))
file.copy(from_path,to_path)
df
})
df <- FT[FT$fi_tag == fi[i],]
View(df)
r <- lapply(1:length(fi),function(i){
df <- FT[FT$fi_tag == fi[i],]
df <- smp_df(df,20)
prefix <- paste('tag',i,'-',sep='')
fn_copy <- fname$fn[fname$svrid %in% df$svrid]
from_path <- file.path(dir_figure,fn_copy)
to_path <- file.path(dir_figure_examine,paste(prefix,fn_copy,sep=''))
file.copy(from_path,to_path)
df
})
r <- lapply(1:length(fi),function(i){
df <- FT[FT$fi_tag == fi[i],]
df[sample(seq_len(nrow(df)),20),]
prefix <- paste('tag',i,'-',sep='')
fn_copy <- fname$fn[fname$svrid %in% df$svrid]
from_path <- file.path(dir_figure,fn_copy)
to_path <- file.path(dir_figure_examine,paste(prefix,fn_copy,sep=''))
file.copy(from_path,to_path)
df
})
i = 1
df <- FT[FT$fi_tag == fi[i],]
df <- df[sample(seq_len(nrow(df)),20),]
prefix <- paste('tag',i,'-',sep='')
fn_copy <- fname$fn[fname$svrid %in% df$svrid]
from_path <- file.path(dir_figure,fn_copy)
to_path <- file.path(dir_figure_examine,paste(prefix,fn_copy,sep=''))
from_path
to_path
dir_figure <- file.path(dir_data,'plot_svrid_iops_2015')
dir_figure_examine <- file.path(dir_data,'plot_svrid_iops_2015_check');check_dir(dir_figure_examine)
fname <- data.frame(fn = list.files(dir_figure));fname$svrid <- gsub('.*-|\\.png','',fname$fn)
r <- lapply(1:length(fi),function(i){
df <- FT[FT$fi_tag == fi[i],]
df <- df[sample(seq_len(nrow(df)),20),]
prefix <- paste('tag',i,'-',sep='')
fn_copy <- fname$fn[fname$svrid %in% df$svrid]
from_path <- file.path(dir_figure,fn_copy)
to_path <- file.path(dir_figure_examine,paste(prefix,fn_copy,sep=''))
file.copy(from_path,to_path)
df
})
seq_len(nrow(df))
sample(100,5)
sample(1:100,3)
r <- lapply(1:length(fi),function(i){
df <- FT[FT$fi_tag == fi[i],]
df <- df[sample(nrow(df),20),]
prefix <- paste('tag',i,'-',sep='')
fn_copy <- fname$fn[fname$svrid %in% df$svrid]
from_path <- file.path(dir_figure,fn_copy)
to_path <- file.path(dir_figure_examine,paste(prefix,fn_copy,sep=''))
file.copy(from_path,to_path)
df
})
?sample.inf
?sample.int
nrow(df)
r <- lapply(1:length(fi),function(i){
df <- FT[FT$fi_tag == fi[i],]
idx <- sample(nrow(df),20)
df <- df[idx,]
prefix <- paste('tag',i,'-',sep='')
fn_copy <- fname$fn[fname$svrid %in% df$svrid]
from_path <- file.path(dir_figure,fn_copy)
to_path <- file.path(dir_figure_examine,paste(prefix,fn_copy,sep=''))
file.copy(from_path,to_path)
df
})
r <- lapply(1:length(fi),function(i){
df <- FT[FT$fi_tag == fi[i],]
cat(sprintf('%d\n',nrow(df)))
idx <- sample(nrow(df),20)
df <- df[idx,]
prefix <- paste('tag',i,'-',sep='')
fn_copy <- fname$fn[fname$svrid %in% df$svrid]
from_path <- file.path(dir_figure,fn_copy)
to_path <- file.path(dir_figure_examine,paste(prefix,fn_copy,sep=''))
file.copy(from_path,to_path)
df
})
FT <- FR
FT$fi_tag <- 'unknown'
fi <- list('Ping .* 不可达',
'agent已经5分钟没有上报数据',
'出错信息:Read-only file system',
'逻辑盘号:.*物理槽位:.*磁盘状态:.*原因:.*',
'盘符:.*物理槽位:.*SN:.*状态:.*',
'槽位：.*硬盘SN：.*',
'TPC异常处理流程发起故障处理流程，异常类型为',
'重启ping检查失败,重启后无法ping通,重启失败.',
'硬盘红灯',
'\\[TSSD 坏盘运维\\]',
'\\[在线换盘\\] IP .*',
'\\[关机换盘\\] IP .*')
for(s in fi){
idx <- which(grepl(s,FT$faultInfo) == T)
# FT$fi_tag[idx] <- gsub("\\\\","",s)
FT$fi_tag[idx] <- s
}
sta1 <- melt_table(FT$fi_tag,FT$faultType)
sta2 <- melt(table(FT$fi_tag))
# Check
splitA <- split(FT,FT$fi_tag)
a <- smp_df(splitA[[11]],100)
dir_figure <- file.path(dir_data,'plot_svrid_iops_2015')
dir_figure_examine <- file.path(dir_data,'plot_svrid_iops_2015_check');check_dir(dir_figure_examine)
fname <- data.frame(fn = list.files(dir_figure));fname$svrid <- gsub('.*-|\\.png','',fname$fn)
r <- lapply(1:length(fi),function(i){
df <- FT[FT$fi_tag == fi[i],]
cat(sprintf('%d\n',nrow(df)))
idx <- sample(nrow(df),20)
df <- df[idx,]
prefix <- paste('tag',i,'-',sep='')
fn_copy <- fname$fn[fname$svrid %in% df$svrid]
from_path <- file.path(dir_figure,fn_copy)
to_path <- file.path(dir_figure_examine,paste(prefix,fn_copy,sep=''))
file.copy(from_path,to_path)
df
})
r <- lapply(1:length(fi),function(i){
df <- FT[FT$fi_tag == fi[i],]
cat(sprintf('%d\n',nrow(df)))
idx <- sample(nrow(df),20)
df <- df[idx,]
prefix <- paste('tag',i,'-',sep='')
fn_copy <- fname$fn[fname$svrid %in% df$svrid]
from_path <- file.path(dir_figure,fn_copy)
to_path <- file.path(dir_figure_examine,paste(prefix,fn_copy,sep=''))
file.copy(from_path,to_path)
df
})
FT_smp <- do.call(rbind,r)
save(FT,FT_smp,file = file.path(dir_data,'classify_failure_type.Rda'))
dir_figure <- file.path(dir_data,'plot_svrid_iops_2015')
dir_figure_examine <- file.path(dir_data,'plot_svrid_iops_2015_check');check_dir(dir_figure_examine)
file.remove(file.path(dir_figure_examine,list.files(dir_figure_examine)))
fname <- data.frame(fn = list.files(dir_figure));fname$svrid <- gsub('.*-|\\.png','',fname$fn)
r <- lapply(1:length(fi),function(i){
df <- FT[FT$fi_tag == fi[i],]
cat(sprintf('%d\n',nrow(df)))
idx <- sample(nrow(df),50)
df <- df[idx,]
prefix <- paste('tag',i,'-',sep='')
fn_copy <- fname$fn[fname$svrid %in% df$svrid]
from_path <- file.path(dir_figure,fn_copy)
to_path <- file.path(dir_figure_examine,paste(prefix,fn_copy,sep=''))
file.copy(from_path,to_path)
df
})
FT_smp <- do.call(rbind,r)
save(FT,FT_smp,file = file.path(dir_data,'classify_failure_type.Rda'))
View(FT_smp)
write.csv(FT_smp,file.path(dir_data,'FT_smp.csv'),row.names = F,quote = F)
write.csv(FT_smp,file.path(dir_data,'FT_smp.csv'),row.names = F)
a <- smp_df(splitA[[6]],100)
a1 <- splitA[[6]]
View(a1)
a1 <- splitA[[5]]
View(a1)
a1 <- splitA[[4]]
View(a1)
a1 <- splitA[[3]]
names(splitA)
a1 <- splitA[[10]]
View(a1)
a1 <- splitA[[9]]
View(a1)
source('~/Code/R/Load_Data_Config_Failure/failRecordLoad2014.R')
eval(expr, envir, enclos)
source('~/Code/R/Load_Data_Config_Failure/Failure_list_preprocess(uwork).R')
View(f2013)
summary(f2013$ftime)
rm(list = ls());setwd('~/Code/R/Disk_Workload/');source('~/rhead');
source('~/Code/R/Load_Data_Config_Failure/loadFunc.R')
load(file.path(dir_dataCF,'uwork2013.Rda'))
load(file.path(dir_dataCF,'uwork2014_06_09.Rda'))
load(file.path(dir_dataCF,'uwork2014.Rda'))
load(file.path(dir_dataCF,'merge_id_svrid.Rda'));f2014M <- merge_id_svrid;rm(merge_id_svrid);
names(f2014M) <- c('ftime','ftype','finfo','svrid','ip','tag','svrnum'); f2014M <- f2014M[,c('svrid','ftime','ftype','finfo','svrnum','ip','tag')]
load(file.path(dir_dataCF,'failRecord_1407-1506.Rda'));f2015 <- failRecord;rm(failRecord)
names(f2015) <- c('svrid','finfo','ftype','ftime');f2015 <- f2015[,c('svrid','ftime','ftype','finfo')]
f2014_06_09_vm <- factorX(f2014_06_09[check_vm(f2014_06_09$svrid),])
f2014_06_09 <- factorX(f2014_06_09[!check_vm(f2014_06_09$svrid),])
f2014_06_09_no_disk_replacing <- factorX(f2014_06_09[!check_disk_replacement(f2014_06_09),])
f2014_06_09 <- factorX(f2014_06_09[check_disk_replacement(f2014_06_09),])
svrid_ftime_2014_06_09 <- paste(f2014_06_09$svrid,f2014_06_09$ftime,sep='-')
svrid_ftime_2014 <- paste(f2014$svrid,f2014$ftime,sep='-')
length(intersect(svrid_ftime_2014_06_09,svrid_ftime_2014))
idx_dif <- match(setdiff(svrid_ftime_2014_06_09,svrid_ftime_2014),svrid_ftime_2014_06_09)
f2014_06_09_non_intersect <- factorX(f2014_06_09[idx_dif,])
f2013_no_disk_replacing <- factorX(f2013[!check_disk_replacement(f2013),])
f2013 <- factorX(f2013[check_disk_replacement(f2013),])
fnum_month_2013 <- melt(table(cut.POSIXt(f2013$ftime,breaks = 'month')))
fnum_month_2014_06_09 <- melt(table(cut.POSIXt(f2014_06_09$ftime,breaks = 'month')))
fnum_month_2014 <- melt(table(cut.POSIXt(f2014$ftime,breaks = 'month')))
fnum_month_2015 <- melt(table(cut.POSIXt(f2015$ftime,breaks = 'month')))
View(fnum_month_2014)
View(fnum_month_2015)
View(fnum_month_2013)
rm(list = ls());setwd('~/Code/R/Disk_Workload/');source('~/rhead');
source('~/Code/R/Load_Data_Config_Failure/loadFunc.R')
#A.[09-13]
load(file.path(dir_dataCF,'uwork2013.Rda'))
#B.[2014_06-09]
load(file.path(dir_dataCF,'uwork2014_06_09.Rda'))
#C1.[2014]
load(file.path(dir_dataCF,'uwork2014.Rda'))
#C2.[2014M]
load(file.path(dir_dataCF,'merge_id_svrid.Rda'));f2014M <- merge_id_svrid;rm(merge_id_svrid);
names(f2014M) <- c('ftime','ftype','finfo','svrid','ip','tag','svrnum'); f2014M <- f2014M[,c('svrid','ftime','ftype','finfo','svrnum','ip','tag')]
#D.[2015]
load(file.path(dir_dataCF,'failRecord_1407-1506.Rda'));f2015 <- failRecord;rm(failRecord)
names(f2015) <- c('svrid','finfo','ftype','ftime');f2015 <- f2015[,c('svrid','ftime','ftype','finfo')]
a <- f2014_06_09
View(f2013)
View(f2014)
View(f2013)
summary(f2013$ftime)
source('~/Code/R/Disk_Workload/Failure/failure_record_comparison.R')
rm(list = ls());setwd('~/Code/R/Disk_Workload/');source('~/rhead');
source('~/Code/R/Load_Data_Config_Failure/loadFunc.R')
#A.[09-13]
load(file.path(dir_dataCF,'uwork2013.Rda'))
#B.[2014_06-09]
load(file.path(dir_dataCF,'uwork2014_06_09.Rda'))
#C1.[2014]
load(file.path(dir_dataCF,'uwork2014.Rda'))
#C2.[2014M]
load(file.path(dir_dataCF,'merge_id_svrid.Rda'));f2014M <- merge_id_svrid;rm(merge_id_svrid);
names(f2014M) <- c('ftime','ftype','finfo','svrid','ip','tag','svrnum'); f2014M <- f2014M[,c('svrid','ftime','ftype','finfo','svrnum','ip','tag')]
#D.[2015]
load(file.path(dir_dataCF,'failRecord_1407-1506.Rda'));f2015 <- failRecord;rm(failRecord)
names(f2015) <- c('svrid','finfo','ftype','ftime');f2015 <- f2015[,c('svrid','ftime','ftype','finfo')]
f2014_06_09_vm <- factorX(f2014_06_09[check_vm(f2014_06_09$svrid),])
f2014_06_09 <- factorX(f2014_06_09[!check_vm(f2014_06_09$svrid),])
f2014_06_09_no_disk_replacing <- factorX(f2014_06_09[!check_disk_replacement(f2014_06_09),])
f2014_06_09 <- factorX(f2014_06_09[check_disk_replacement(f2014_06_09),])
function (e1, e2)
rm(list = ls());setwd('~/Code/R/Disk_Workload/');source('~/rhead');
source('~/Code/R/Load_Data_Config_Failure/loadFunc.R')
#A.[09-13]
load(file.path(dir_dataCF,'uwork2013.Rda'))
#B.[2014_06-09]
load(file.path(dir_dataCF,'uwork2014_06_09.Rda'))
#C1.[2014]
load(file.path(dir_dataCF,'uwork2014.Rda'))
#C2.[2014M]
load(file.path(dir_dataCF,'merge_id_svrid.Rda'));f2014M <- merge_id_svrid;rm(merge_id_svrid);
names(f2014M) <- c('ftime','ftype','finfo','svrid','ip','tag','svrnum'); f2014M <- f2014M[,c('svrid','ftime','ftype','finfo','svrnum','ip','tag')]
#D.[2015]
load(file.path(dir_dataCF,'failRecord_1407-1506.Rda'));f2015 <- failRecord;rm(failRecord)
names(f2015) <- c('svrid','finfo','ftype','ftime');f2015 <- f2015[,c('svrid','ftime','ftype','finfo')]
# C1. compare B and C1/C2 in order to tell if disk failure of B is included by C1/C2. The Answer is YES.
f2014_06_09_vm <- factorX(f2014_06_09[check_vm(f2014_06_09$svrid),])
f2014_06_09 <- factorX(f2014_06_09[!check_vm(f2014_06_09$svrid),])
f2014_06_09_no_disk_replacing <- factorX(f2014_06_09[!check_disk_replacement(f2014_06_09),])
source('~/Code/R/Load_Data_Config_Failure/loadFunc.R')
f2014_06_09_no_disk_replacing <- check_disk_replacement(f2014_06_09,valid = -1)
f2014_06_09 <- check_disk_replacement(f2014_06_09,valid = 1)
View(f2014_06_09)
svrid_ftime_2014_06_09 <- paste(f2014_06_09$svrid,f2014_06_09$ftime,sep='-')
svrid_ftime_2014 <- paste(f2014$svrid,f2014$ftime,sep='-')
length(intersect(svrid_ftime_2014_06_09,svrid_ftime_2014))
idx_dif <- match(setdiff(svrid_ftime_2014_06_09,svrid_ftime_2014),svrid_ftime_2014_06_09)
f2014_06_09_non_intersect <- factorX(f2014_06_09[idx_dif,])
f2013_no_disk_replacing <- factorX(f2013[!check_disk_replacement(f2013),])
f2013 <- check_disk_replacement(f2013)
fnum_month_2013 <- melt(table(cut.POSIXt(f2013$ftime,breaks = 'month')))
fnum_month_2014_06_09 <- melt(table(cut.POSIXt(f2014_06_09$ftime,breaks = 'month')))
fnum_month_2014 <- melt(table(cut.POSIXt(f2014$ftime,breaks = 'month')))
fnum_month_2015 <- melt(table(cut.POSIXt(f2015$ftime,breaks = 'month')))
View(fnum_month_2013)
View(fnum_month_2014)
View(fnum_month_2014_06_09)
View(fnum_month_2015)
View(f2014_06_09)
summary(f2014_06_09$ftype)
source('~/Code/R/Load_Data_Config_Failure/loadFunc.R')
source('~/Code/R/Load_Data_Config_Failure/loadFunc.R')
rm(list = ls());setwd('~/Code/R/Disk_Workload/');source('~/rhead');
source('~/Code/R/Load_Data_Config_Failure/loadFunc.R')
#A.[09-13]
load(file.path(dir_dataCF,'uwork2013.Rda'))
#B.[2014_06-09]
load(file.path(dir_dataCF,'uwork2014_06_09.Rda'))
#C1.[2014]
load(file.path(dir_dataCF,'uwork2014.Rda'))
#C2.[2014M]
load(file.path(dir_dataCF,'merge_id_svrid.Rda'));f2014M <- merge_id_svrid;rm(merge_id_svrid);
names(f2014M) <- c('ftime','ftype','finfo','svrid','ip','tag','svrnum'); f2014M <- f2014M[,c('svrid','ftime','ftype','finfo','svrnum','ip','tag')]
#D.[2015]
load(file.path(dir_dataCF,'failRecord_1407-1506.Rda'));f2015 <- failRecord;rm(failRecord)
names(f2015) <- c('svrid','finfo','ftype','ftime');f2015 <- f2015[,c('svrid','ftime','ftype','finfo')]
# C1. compare B and C1/C2 in order to tell if disk failure of B is included by C1/C2. The Answer is YES.
f2014_06_09_vm <- factorX(f2014_06_09[check_vm(f2014_06_09$svrid),])
f2014_06_09 <- factorX(f2014_06_09[!check_vm(f2014_06_09$svrid),])
f2014_06_09_no_disk_replacing <- check_disk_replacement(f2014_06_09,valid = -1)
f2014_06_09 <- check_disk_replacement(f2014_06_09,valid = 1)
svrid_ftime_2014_06_09 <- paste(f2014_06_09$svrid,f2014_06_09$ftime,sep='-')
svrid_ftime_2014 <- paste(f2014$svrid,f2014$ftime,sep='-')
length(intersect(svrid_ftime_2014_06_09,svrid_ftime_2014))
idx_dif <- match(setdiff(svrid_ftime_2014_06_09,svrid_ftime_2014),svrid_ftime_2014_06_09)
f2014_06_09_non_intersect <- factorX(f2014_06_09[idx_dif,])
# C2. compare number of failure between [2013] and [2014_06_09]. They are very similar in number. But they are different to [2014] and [2015]
f2013_no_disk_replacing <- factorX(f2013[!check_disk_replacement(f2013),])
f2013 <- check_disk_replacement(f2013)
fnum_month_2013 <- melt(table(cut.POSIXt(f2013$ftime,breaks = 'month')))
fnum_month_2014_06_09 <- melt(table(cut.POSIXt(f2014_06_09$ftime,breaks = 'month')))
fnum_month_2014 <- melt(table(cut.POSIXt(f2014$ftime,breaks = 'month')))
fnum_month_2015 <- melt(table(cut.POSIXt(f2015$ftime,breaks = 'month')))
rm(list = ls());setwd('~/Code/R/Disk_Workload/');source('~/rhead');
source('~/Code/R/Load_Data_Config_Failure/loadFunc.R')
#A.[09-13]
load(file.path(dir_dataCF,'uwork2013.Rda'))
#B.[2014_06-09]
load(file.path(dir_dataCF,'uwork2014_06_09.Rda'))
#C1.[2014]
load(file.path(dir_dataCF,'uwork2014.Rda'))
#C2.[2014M]
load(file.path(dir_dataCF,'merge_id_svrid.Rda'));f2014M <- merge_id_svrid;rm(merge_id_svrid);
names(f2014M) <- c('ftime','ftype','finfo','svrid','ip','tag','svrnum'); f2014M <- f2014M[,c('svrid','ftime','ftype','finfo','svrnum','ip','tag')]
#D.[2015]
load(file.path(dir_dataCF,'failRecord_1407-1506.Rda'));f2015 <- failRecord;rm(failRecord)
names(f2015) <- c('svrid','finfo','ftype','ftime');f2015 <- f2015[,c('svrid','ftime','ftype','finfo')]
f2014_06_09_vm <- factorX(f2014_06_09[check_vm(f2014_06_09$svrid),])
f2014_06_09 <- factorX(f2014_06_09[!check_vm(f2014_06_09$svrid),])
f2014_06_09_no_disk_replacing <- check_disk_replacement(f2014_06_09,valid = -1)
f2014_06_09 <- check_disk_replacement(f2014_06_09,valid = 1)
svrid_ftime_2014_06_09 <- paste(f2014_06_09$svrid,f2014_06_09$ftime,sep='-')
svrid_ftime_2014 <- paste(f2014$svrid,f2014$ftime,sep='-')
length(intersect(svrid_ftime_2014_06_09,svrid_ftime_2014))
idx_dif <- match(setdiff(svrid_ftime_2014_06_09,svrid_ftime_2014),svrid_ftime_2014_06_09)
f2014_06_09_non_intersect <- factorX(f2014_06_09[idx_dif,])
head(idx_dif)
rm(list = ls());setwd('~/Code/R/Disk_Workload/');source('~/rhead');
source('~/Code/R/Load_Data_Config_Failure/loadFunc.R')
#A.[09-13]
load(file.path(dir_dataCF,'uwork2013.Rda'))
#B.[2014_06-09]
load(file.path(dir_dataCF,'uwork2014_06_09.Rda'))
#C1.[2014]
load(file.path(dir_dataCF,'uwork2014.Rda'))
#C2.[2014M]
load(file.path(dir_dataCF,'merge_id_svrid.Rda'));f2014M <- merge_id_svrid;rm(merge_id_svrid);
names(f2014M) <- c('ftime','ftype','finfo','svrid','ip','tag','svrnum'); f2014M <- f2014M[,c('svrid','ftime','ftype','finfo','svrnum','ip','tag')]
#D.[2015]
load(file.path(dir_dataCF,'failRecord_1407-1506.Rda'));f2015 <- failRecord;rm(failRecord)
names(f2015) <- c('svrid','finfo','ftype','ftime');f2015 <- f2015[,c('svrid','ftime','ftype','finfo')]
# C1. compare B and C1/C2 in order to tell if disk failure of B is included by C1/C2. The Answer is YES.
f2014_06_09_vm <- factorX(f2014_06_09[check_vm(f2014_06_09$svrid),])
f2014_06_09 <- factorX(f2014_06_09[!check_vm(f2014_06_09$svrid),])
f2014_06_09_no_disk_replacing <- check_disk_replacement(f2014_06_09,valid = -1)
a <- ifelse(1,10,11)
a
a <- ifelse(1,factorX(f2013),factorX(f2014))
source('~/Code/R/Load_Data_Config_Failure/loadFunc.R')
rm(list = ls());setwd('~/Code/R/Disk_Workload/');source('~/rhead');
source('~/Code/R/Load_Data_Config_Failure/loadFunc.R')
#A.[09-13]
load(file.path(dir_dataCF,'uwork2013.Rda'))
#B.[2014_06-09]
load(file.path(dir_dataCF,'uwork2014_06_09.Rda'))
#C1.[2014]
load(file.path(dir_dataCF,'uwork2014.Rda'))
#C2.[2014M]
load(file.path(dir_dataCF,'merge_id_svrid.Rda'));f2014M <- merge_id_svrid;rm(merge_id_svrid);
names(f2014M) <- c('ftime','ftype','finfo','svrid','ip','tag','svrnum'); f2014M <- f2014M[,c('svrid','ftime','ftype','finfo','svrnum','ip','tag')]
#D.[2015]
load(file.path(dir_dataCF,'failRecord_1407-1506.Rda'));f2015 <- failRecord;rm(failRecord)
names(f2015) <- c('svrid','finfo','ftype','ftime');f2015 <- f2015[,c('svrid','ftime','ftype','finfo')]
# C1. compare B and C1/C2 in order to tell if disk failure of B is included by C1/C2. The Answer is YES.
f2014_06_09_vm <- factorX(f2014_06_09[check_vm(f2014_06_09$svrid),])
f2014_06_09 <- factorX(f2014_06_09[!check_vm(f2014_06_09$svrid),])
f2014_06_09_no_disk_replacing <- check_disk_replacement(f2014_06_09,valid = -1)
f2014_06_09 <- check_disk_replacement(f2014_06_09,valid = 1)
svrid_ftime_2014_06_09 <- paste(f2014_06_09$svrid,f2014_06_09$ftime,sep='-')
svrid_ftime_2014 <- paste(f2014$svrid,f2014$ftime,sep='-')
length(intersect(svrid_ftime_2014_06_09,svrid_ftime_2014))
idx_dif <- match(setdiff(svrid_ftime_2014_06_09,svrid_ftime_2014),svrid_ftime_2014_06_09)
f2014_06_09_non_intersect <- factorX(f2014_06_09[idx_dif,])
f2013_no_disk_replacing <- factorX(f2013[!check_disk_replacement(f2013),])
f2013 <- check_disk_replacement(f2013)
fnum_month_2013 <- melt(table(cut.POSIXt(f2013$ftime,breaks = 'month')))
fnum_month_2014_06_09 <- melt(table(cut.POSIXt(f2014_06_09$ftime,breaks = 'month')))
fnum_month_2014 <- melt(table(cut.POSIXt(f2014$ftime,breaks = 'month')))
fnum_month_2015 <- melt(table(cut.POSIXt(f2015$ftime,breaks = 'month')))
rm(list = ls());setwd('~/Code/R/Disk_Workload/');source('~/rhead');
source('~/Code/R/Load_Data_Config_Failure/loadFunc.R')
#A.[09-13]
load(file.path(dir_dataCF,'uwork2013.Rda'))
#B.[2014_06-09]
load(file.path(dir_dataCF,'uwork2014_06_09.Rda'))
#C1.[2014]
load(file.path(dir_dataCF,'uwork2014.Rda'))
#C2.[2014M]
load(file.path(dir_dataCF,'merge_id_svrid.Rda'));f2014M <- merge_id_svrid;rm(merge_id_svrid);
names(f2014M) <- c('ftime','ftype','finfo','svrid','ip','tag','svrnum'); f2014M <- f2014M[,c('svrid','ftime','ftype','finfo','svrnum','ip','tag')]
#D.[2015]
load(file.path(dir_dataCF,'failRecord_1407-1506.Rda'));f2015 <- failRecord;rm(failRecord)
names(f2015) <- c('svrid','finfo','ftype','ftime');f2015 <- f2015[,c('svrid','ftime','ftype','finfo')]
# C1. compare B and C1/C2 in order to tell if disk failure of B is included by C1/C2. The Answer is YES.
f2014_06_09_vm <- factorX(f2014_06_09[check_vm(f2014_06_09$svrid),])
f2014_06_09 <- factorX(f2014_06_09[!check_vm(f2014_06_09$svrid),])
f2014_06_09_no_disk_replacing <- check_disk_replacement(f2014_06_09,valid = -1)
f2014_06_09 <- check_disk_replacement(f2014_06_09,valid = 1)
svrid_ftime_2014_06_09 <- paste(f2014_06_09$svrid,f2014_06_09$ftime,sep='-')
svrid_ftime_2014 <- paste(f2014$svrid,f2014$ftime,sep='-')
length(intersect(svrid_ftime_2014_06_09,svrid_ftime_2014))
idx_dif <- match(setdiff(svrid_ftime_2014_06_09,svrid_ftime_2014),svrid_ftime_2014_06_09)
f2014_06_09_non_intersect <- factorX(f2014_06_09[idx_dif,])
# C2. compare number of failure between [2013] and [2014_06_09]. They are very similar in number. But they are different to [2014] and [2015]
f2013_no_disk_replacing <- check_disk_replacement(f2013,valid = 0)
f2013 <- check_disk_replacement(f2013)
fnum_month_2013 <- melt(table(cut.POSIXt(f2013$ftime,breaks = 'month')))
fnum_month_2014_06_09 <- melt(table(cut.POSIXt(f2014_06_09$ftime,breaks = 'month')))
fnum_month_2014 <- melt(table(cut.POSIXt(f2014$ftime,breaks = 'month')))
fnum_month_2015 <- melt(table(cut.POSIXt(f2015$ftime,breaks = 'month')))
View(fnum_month_2014_06_09)
View(f2014_06_09)
